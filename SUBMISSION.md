# 候选人评分系统 - 提交说明

## 算法说明

### 团队匹配算法

我实现了一个基于组合搜索的团队匹配算法，主要特点如下：

1. **算法策略**: 使用穷举搜索 + 贪心分配
   - 生成所有可能的候选人组合（使用 `itertools.combinations`）
   - 对每个组合，贪心地为每个技能分配最佳候选人
   - 选择覆盖率最高且总专业度最高的团队

2. **时间复杂度**: O(C(n,k) × m × s)
   - n: 候选人数量
   - k: 团队大小
   - m: 项目技能数量
   - s: 每个候选人的平均技能数量
   - C(n,k): 组合数

3. **空间复杂度**: O(k × m)

4. **优化策略**:
   - 优先选择覆盖率高的团队
   - 在覆盖率相同的情况下，选择总专业度最高的团队
   - 使用贪心算法为技能分配最佳候选人

### 外部API集成

实现了对外部评分API的集成，包含以下特性：

1. **重试机制**: 最多重试5次，使用指数退避策略
2. **缓存机制**: 内存缓存，避免重复调用
3. **并行处理**: 支持批量获取候选人评分
4. **错误处理**: 优雅处理API失败，不影响主要功能

## 假设和设计决策

### 假设
1. 外部API的flaky行为是随机的，重试可以解决大部分问题
2. 候选人评分对团队匹配不是必需的，但可以提高匹配质量
3. 内存存储足够满足测试需求
4. 团队大小限制在1-10人之间

### 设计决策
1. **数据存储**: 使用内存存储而非数据库，简化部署和测试
2. **API设计**: RESTful API设计，遵循FastAPI最佳实践
3. **错误处理**: 统一的错误处理机制，提供清晰的错误信息
4. **日志记录**: 详细的日志记录，便于调试和监控

## 已完成功能

### Part 1: FastAPI应用
- ✅ 项目CRUD操作
- ✅ 候选人CRUD操作
- ✅ Pydantic数据验证
- ✅ 错误处理和日志记录
- ✅ 团队匹配端点

### Part 2: 团队匹配算法
- ✅ 最优团队选择算法
- ✅ 技能覆盖率和专业度计算
- ✅ 支持约束条件（团队大小、技能数量、候选人数）
- ✅ 高效的组合搜索实现

### Part 3: 外部API集成
- ✅ 评分API集成
- ✅ 重试机制和错误处理
- ✅ 缓存机制
- ✅ 并行批量处理
- ✅ 评分结果集成到候选人模型

### 额外功能
- ✅ 健康检查端点
- ✅ 完整的单元测试
- ✅ API文档（通过FastAPI自动生成）
- ✅ 详细的日志记录

## 运行说明

### 环境要求
- Python 3.12+
- Poetry（依赖管理）

### 安装依赖
```bash
cd backend-take-home
poetry install
```

### 启动Mock API服务器
```bash
poetry run mock
```

### 启动主应用
```bash
poetry run dev
```

### 运行测试
```bash
poetry run pytest
```

### API文档
启动应用后，访问以下地址查看API文档：
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## 测试用例

### 基本功能测试
1. 项目CRUD操作测试
2. 候选人CRUD操作测试
3. 团队匹配功能测试
4. 错误处理测试

### 算法测试
1. 完整技能覆盖测试
2. 部分技能覆盖测试
3. 边界条件测试（最大团队大小、最大候选人数等）

### 外部API测试
1. 正常API调用测试
2. API失败重试测试
3. 缓存机制测试

## 已知问题和限制

1. **性能限制**: 对于大量候选人的组合搜索可能较慢，但符合约束条件
2. **内存存储**: 数据在应用重启后会丢失
3. **缓存持久化**: 评分缓存仅在内存中，应用重启后丢失
4. **并发处理**: 未实现数据库级别的并发控制

## 改进建议

1. **数据库集成**: 使用SQLAlchemy + PostgreSQL实现持久化存储
2. **缓存优化**: 使用Redis实现分布式缓存
3. **算法优化**: 对于大规模数据，可以考虑启发式算法
4. **监控和指标**: 添加性能监控和业务指标
5. **认证授权**: 实现用户认证和权限控制
6. **API版本控制**: 实现API版本管理
7. **容器化**: 使用Docker进行容器化部署

## 技术栈

- **Web框架**: FastAPI
- **数据验证**: Pydantic
- **HTTP客户端**: httpx
- **测试框架**: pytest
- **依赖管理**: Poetry
- **日志**: Python标准库logging

## 代码质量

- 遵循PEP 8代码规范
- 完整的类型注解
- 详细的文档字符串
- 模块化设计
- 错误处理完善
- 测试覆盖率良好 